# 0.0.2

Multi-Instance Protection:

- Add single-instance mutex to prevent concurrent executions and data corruption

Logging and Diagnostics:

- Add `yt-dlp` session log viewer dialog with real-time updates
- Implement "All Logs" tab showing complete session history
- Implement "Current Run" / "Last Run" tab that changes based on `yt-dlp` execution status
- Add automatic log refresh every 250ms with auto-scroll to bottom
- Implement in-memory session log tracking with real-time capture from subprocess output
- Use monospaced Consolas font for log display and Technical Details tabs

Memory Management:

- Fix double-free vulnerabilities in cleanup functions by NULLing pointers after freeing

URL Validation:

- Add validation to Get Info and Download buttons to reject invalid URLs
- Reject multiple space-separated URLs and YouTube playlist URLs
- Display informative error dialogs explaining supported URL formats

Cache ListView Enhancements:

- Add column header sorting with ascending/descending toggle
- Add comprehensive right-click context menu with Delete, Copy operations, and Select All
- Add `Del` and `Ctrl+C` keyboard accelerators
- Implement Edit menu with focus-aware enabling for `ListView` and edit controls
- Add Copy Title, Copy Path, and Copy YouTube URL menu items
- Disable Copy operations when multiple items are selected

HiDPI Support:

- Add centralized DPI management system with `DPIManager` and per-window `DPIContext` tracking
- Implement per-monitor DPI awareness v2 with fallback chain for older Windows versions
- Add dynamic DPI change handling via `WM_DPICHANGED` for all windows and dialogs
- Implement font scaling system with `FontManager` for automatic font rescaling on DPI changes
- Implement icon scaling system with `IconManager` for multi-size icon support
- Add window position persistence using DPI-independent logical coordinates
- Fix DPI change layout drift by recalculating from window dimensions instead of scaling positions
- Add custom About dialog layout recalculation for proper DPI scaling

Accessibility and Keyboard Navigation:

- Add screen reader support with accessible names and state change notifications
- Implement high contrast mode support with dynamic color updates via `WM_SYSCOLORCHANGE`
- Add tab order management system with automatic logical ordering
- Add accelerator key system with conflict detection
- Implement focus management for proper keyboard navigation

Reusable UI Components:

- Add component system with `FileBrowserComponent`, `FolderBrowserComponent`, `LabeledTextInput`, and `ButtonRowComponent`
- Implement validation framework with visual error feedback (red borders and error labels)
- Add dialog validation integration to prevent closing on validation failure
- Update Settings dialog to use reusable components with validation

Build System:

- Add `dpi.c`, `accessibility.c`, `keyboard.c`, and `components.c` to build system
- Update Makefile dependencies for new HiDPI and dialog enhancement modules
- Add ARM64 cross-compilation support using `aarch64-w64-mingw32-gcc` toolchain
- Add ARM64 build targets (`debugarm64`, `releasearm64`) with `objarm64` object directory
- Enable Link Time Optimization (LTO) with `-flto` flag for release builds
- Update Makefile dependencies for new HiDPI and dialog enhancement modules
- Add ARM64 cross-compilation support using `aarch64-w64-mingw32-gcc` toolchain
- Add ARM64 build targets (`debugarm64`, `releasearm64`) with `objarm64` object directory

# 0.0.1

Memory Management:

- Add comprehensive memory management system with leak detection
- Add memory pools for frequent allocations
- Add RAII resource management patterns (`AutoResource`, `AutoString`, `AutoArray`)
- Add error-safe allocation patterns with `AllocationSet` and `BulkCleanup`
- Add memory error handling with double-free and use-after-free detection
- Add buffer overrun detection with guard patterns in debug builds
- Add thread-safe allocation tracking with critical sections
- Add memory leak detection with hash table optimization
- Migrate all existing allocations to safe memory wrappers
- Implement robust memory management with validated allocation tracking
- Fix critical `SafeFree` bug with allocation integrity validation
- Replace complex hash table with reliable linear search for allocation tracking
- Fix double-free detection to respect leak detection state
- Fix `Base64DecodeWide` memory corruption issues
- Fix cached metadata allocation problems
- Fix `SAFE_REALLOC` buffer overrun detection
- Fix memory manager circular dependency in `CreateMemoryPool`
- Fix allocation removal logic to prevent hash table corruption

User Interface:

- Unify dialog system with consistent 2-tab layout
- Add HiDPI and font-aware About dialog
- Add dynamic layout system that adjusts to system DPI and font settings
- Fix dialog line endings for proper Windows text control display
- Fix debug dialog line endings for Windows text controls
- Fix unified dialog layout per Microsoft UI standards
- Add debug test buttons for dialog system testing (debug mode only)
- Replace all legacy dialog functions with unified dialog system
- Remove popup progress dialogs and use main window progress controls only
- Fix UI freezing during downloads with asynchronous metadata retrieval
- Fix unified dialog button sizes to proper Windows standards (`75px Ã— 23px`)
- Fix unified dialog edge padding to proper `11px` margins (7 DLU standard)
- Fix icon-text vertical alignment to center text with icon (or icon with text if text is taller)

Download System:

- Add intelligent metadata caching between Get Info and Download buttons
- Fix video metadata extraction during download
- Prevent double downloads and simplify metadata handling
- Add proper video title and duration storage in cache
- Format duration before storing in cache
- Add download cancellation with automatic cleanup
- Enable real-time progress updates during downloads
- Fix download hang by processing carriage return line terminators
- Fix `yt-dlp` progress tracking with proper template field names
- Remove `--print-json` flag that was blocking progress updates
- Fix download progress display and timeout issues
- Add detailed status messages during download (webpage, player API, format selection)
- Improve progress reporting with granular `yt-dlp` operation status updates
- Preserve duration processing functionality

Error Handling:

- Add enhanced error reporting with detailed error codes and diagnostics
- Implement error handling system with `UnifiedDialog` integration
- Add error context system with detailed error tracking
- Add error handling macros for memory allocation, parameter validation, and system calls
- Update `yt-dlp` subprocess error handling with standardized error macros
- Update UI error handling integration with new `ErrorContext` system
- Update file operation error handling in `cache.c` with detailed context
- Add comprehensive error logging and validation messages
- Improve error message extraction for user-friendly display
- Improve `yt-dlp` error message extraction for cleaner user display

Thread Safety and Concurrency:

- Add thread-safe logging system with `ThreadSafeDebugOutput` functions
- Implement thread-safe global state wrappers and access functions
- Add `ThreadContext` structure with lifecycle tracking
- Enhance `ThreadContext` with timeout, start time, and thread name fields
- Implement `CreateManagedThread` with proper initialization and naming
- Add `WaitForThreadCompletion` with timeout support
- Implement `ForceTerminateThread` for unresponsive threads

Performance:

- Implement high-performance cache loading with optimized file processing
- Fix slow startup and shutdown performance issues
- Remove excessive newlines from log file

Cache Management:

- Fix `cache_index.txt` not being saved on program exit
- Add comprehensive file deletion logging

Crash Fixes:

- Fix startup and exit crashes related to memory management
- Remove duplicate cleanup calls causing exit crashes
- Fix double-close crash on process thread handle
- Fix crash in `CancelThreadSafeSubprocess` critical section
- Remove critical section usage during cleanup to prevent corruption
- Prevent double-cleanup of `ThreadSafeSubprocessContext`
- Skip cancellation in cleanup if process already completed
- Fix shutdown crash caused by improper window cleanup order
- Fix multiple handle double-close crashes during download completion
- Add defensive handle validation using `DuplicateHandle` before closing handles
- Fix `cancellationEvent` double-close on initialization failure
- Fix critical section deletion crashes from corrupted contexts
- Add memory corruption detection in `CleanupThreadSafeSubprocessContext`
- Fix invalid handle crashes in `ClearActiveDownload`
- Add `ExitProcess` workaround for third-party hook interference during shutdown
- Explicitly destroy child windows before final cleanup to prevent hook crashes

Logging and Debugging:

- Add detailed command line logging for `yt-dlp` execution
- Fix truncated logging by using dynamic buffer allocation
- Add proper Windows resource handling and cleanup

Build System:

- Update build system with `debug`/`release` flags and `dbghelp` library linking
- Add strict compilation with `-Wall -Wextra -Werror` flags

Build System:

- Add accessibility.c, keyboard.c, and components.c to Makefile SOURCES
- Add dependency tracking for accessibility.o, keyboard.o, and components.o
- Verify clean builds with all new dialog system enhancement modules
